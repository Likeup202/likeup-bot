{
  "name": "setrole",
  "permissions": "NONE",
  "restriction": "1",
  "_id": "GdFLP",
  "actions": [
    {
      "behavior": "1",
      "interpretation": "1",
      "code": "        var roleStored = [];\n        var embed = {\n            \"title\": \"Automated Captcha System\",\n            \"description\": `Please mention a role, role id, or role name to set a captcha channel for it!\\n\\nIf you want to disable captcha, please just respond with the number 0\\n\\nIf you want to enable the captcha but give no role, please respond with the number 1\\n\\nIf you would like to input multiple roles, please respond by id or mention of the role.\\nThe roles should be seperated by spaces for ids. Any mention format works.\\n\\nYou **cannot** mix mentions and ids. Only the mentions would be counted.`,\n            \"color\": 0x00ff00\n        }\n        if (msg.guild.me.hasPermission(\"MANAGE_ROLES\")) {\n\n            if (msg.member.hasPermission(\"MANAGE_GUILD\")) {\n                msg.channel.send({embed: embed}).then(sentMessage => {\n                    msg.channel.awaitMessages(m => m.author.id == msg.author.id, {\n                            max: 1,\n                            time: 120000,\n                            errors: ['time']\n                        })\n                        .then(collected => {\n                            var roleInfo = collected.first();\n                            collected.first().delete();\n\n                            if (roleInfo.content == 0) {\n                                msg.guild.setData(\"serverCaptchaRole\", 0);\n                                embed[\"description\"] = `The captcha system has been disabled!`;\n                                sentMessage.edit({\n                                    embed: embed\n                                });\n                            } else if (roleInfo.content == 1) {\n                                msg.guild.setData(\"serverCaptchaRole\", 1);\n                                embed[\"description\"] = `The captcha system has been enabled but will give no roles!`;\n                                sentMessage.edit({\n                                    embed: embed\n                                });\n                            } else {\n                                if (roleInfo.mentions.roles.first() != null) {\n                                    roleInfo.mentions.roles.each(roles => roleStored.push(roles));\n                                } else if (!isNaN(roleInfo.content.split(\" \")[0])) {\n                                    roleInfo.content.split(\" \").forEach(roleIDS => {\n                                        if(!isNaN(roleIDS)) {\n                                            var attemptFetch = msg.guild.roles.cache.get(roleIDS);\n\n                                            if (attemptFetch != null) {\n                                                roleStored.push(attemptFetch);\n                                            }\n                                        }\n                                    })\n                                } else {\n                                    var attemptFetch = msg.guild.roles.cache.find(role => role.name == roleInfo.content);\n\n                                    if (attemptFetch != null) {\n                                        roleStored.push(attemptFetch);\n                                    }\n                                }\n\n                                if (roleStored.length != 0) {\n                                    var finalRoles = [];\n                                    var finalMentions = \"\";\n                                    var finalMSG = [];\n\n                                    roleStored.forEach(role => {\n                                        if (role.position < msg.guild.me.roles.highest.position) {\n                                            finalRoles.push(role.id);\n                                            finalMentions += `${role}`\n                                        } else {\n                                            finalMSG.push(role);\n                                        }\n                                    })\n                                    \n\n                                    if (finalRoles.length > 0 ) {\n                                        msg.guild.setData(\"serverCaptchaRole\", finalRoles);\n\n                                        var extraMSG = \"You have provided a role with a higher position than what I have!\\n\\nRole(s):\\n\";\n                                        if (finalMSG.length != 0) {\n                                            finalMSG.forEach(violatingRole=>{\n                                                extraMSG += `${violatingRole} `;\n                                            })\n                                        }\n                                        \n                                        embed[\"description\"] = `The automatic role(s) to give has been set to: ${finalMentions}!\\n\\n${finalMSG}`;\n                                        sentMessage.edit({\n                                            embed: embed\n                                        });\n                                    } else {\n                                        errorMSG(`You have provided a role(s) with a higher position than what I have!`, sentMessage);\n                                    }\n                                } else {\n                                    errorMSG(`You did not provide a valid role mention, id, or name!`, sentMessage);\n                                }\n\n                            }\n                        })\n                        .catch(err => {\n                            console.log(err);\n                            errorMSG(`You did not respond in time!`, sentMessage);\n                        })\n                })\n            } else {\n\n                embed[\"color\"] = 0xff0000;\n                embed[\"description\"] = `You do not have the sufficent permission to run this command!`;\n                msg.channel.send({\n                    embed: embed\n                });\n            }\n        } else {\n            embed[\"color\"] = 0xff0000;\n            embed[\"description\"] = `I don't have the sufficient permission to give roles!`;\n            msg.channel.send({\n                embed: embed\n            });\n        }\n\n        function errorMSG(errorMsg, message) {\n            var ErrorEmbed = {\n                \"title\": \"Automated Captcha System\",\n                \"description\": errorMsg,\n                \"color\": 0xff0000\n            }\n\n            message.edit({\n                embed: ErrorEmbed\n            })\n        }\n\n// VersionCheck:3",
      "storage": "0",
      "varName": "",
      "name": "Run Script"
    }
  ]
}